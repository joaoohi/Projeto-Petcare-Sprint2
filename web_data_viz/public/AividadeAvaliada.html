<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <div id="div_1">
        <h1>Cadastro</h1><br>

        Nome de usuário: <input type="text" id="ipt_nome"><br>

        Senha: <input type="text" id="ipt_senha"><br>

        <button onclick="cadastrar()">Ver grupo </button><br>

        <div id="div_mensagem"></div><br>
        <div><button onclick="parte2()" id="avancar" style="display:none;">Ir para login</button></div>

    </div>

    <div id="div_2">
        <h1>Login</h1>

        Nome de usuário: <input type="text" id="ipt_nomeLogin"><br>

        Senha: <input type="text" id="ipt_senhaLogin"><br>

        Grupo que pertence: <select id="ipt_grupo">
            <option value="1">Ouro</option>
            <option value="2">Prata</option>
            <option value="3">Bronze</option>
            <option value="4">Cobre</option>
        </select> <br>

        <button onclick="logar()">Login</button><br>
        <div id="div_mensagemLogin"></div>

    </div>
    <div id="div_3">
        <button onclick="compra()">Realizar Compra</button><br>
        <div id="div_mensagemCompra"></div>
    </div>
</body>

</html>
<script>
    div_2.style.display = 'none';
    div_3.style.display = 'none';

    var nomeSalvo = ''
    var senhaSalvo = ''
    var grupoSalvo = ''
    function cadastrar() {

        var mensagem = ''

        var nome = ipt_nome.value;
        var senha = ipt_senha.value;

        var nome_Sem_Espaço = nome.includes(' ',)
        var caractereEspecialNome = nome.includes('!') ||
            nome.includes('@') ||
            nome.includes('#') ||
            nome.includes('$') ||
            nome.includes('%') ||
            nome.includes('&')


        var senha_Tamanho = senha.length;
        var senha_Maiuscula = senha.toUpperCase()
        var senha_Minusculo = senha.toLowerCase()
        var numeros =
            senha.includes('0') ||
            senha.includes('1') ||
            senha.includes('2') ||
            senha.includes('3') ||
            senha.includes('4') ||
            senha.includes('5') ||
            senha.includes('6') ||
            senha.includes('7') ||
            senha.includes('8') ||
            senha.includes('9')

        var caractereEspecialSenha = senha.includes('!') ||
            senha.includes('@') ||
            senha.includes('#') ||
            senha.includes('$') ||
            senha.includes('%') ||
            senha.includes('&')

        // Nome
        if (nome_Sem_Espaço || caractereEspecialNome) {
            mensagem += 'Nome de usuário inválido. Verifique os caracteres utilizados.'
        } else {
            var nomeCadastro    = true

        }

        // Senha
        if (senha_Tamanho >= 8 && caractereEspecialSenha && senha !== senha_Maiuscula && senha !== senha_Minusculo && numeros) {
            var senhaCadastro = true
        } else {
            mensagem += 'A senha deve conter no mínimo 8 caracteres, com ao menos um caractere especial, uma letra maiúscula, uma letra minúscula e um número'
        }

        var numeroGrupo = Math.random()
        var numeroAleatorio = numeroGrupo * 3 + 1
        var grupo = numeroAleatorio.toFixed(0)
        var codigo = ''

        if (grupo == 1) {
            codigo += 'Grupo Ouro: Desconto de 20% em todas as compras'
        } else if (grupo == 2) {
            codigo += 'Grupo Prata: Desconto de 15% em todas as compras.'
        } else if (grupo == 3) {
            codigo += 'Grupo Bronze: Desconto de 10% em todas as compras.'
        } else if (grupo == 4) {
            codigo += 'Grupo Cobre: Desconto de 5% em todas as compras.'
        }

        if (nomeCadastro == true && senhaCadastro == true) {
            mensagem += `Cadastrado Concluído!<br>
                --------------------------------<br>
                usuário: ${nome}<br>
                senha: ${senha}<br>
                código do grupo: ${grupo}<br>
                descrição: ${codigo}`;


            nomeSalvo = nome
            senhaSalvo = senha
            grupoSalvo = grupo

            div_mensagem.innerHTML = mensagem
            avancar.style.display = 'block';
        }

    }
    function parte2() {
        div_1.style.display = 'none';
        div_2.style.display = 'block';
    }
    function logar() {
        var nomeLogin = ipt_nomeLogin.value
        var senhaLogin = ipt_senhaLogin.value
        var grupoLogin = ipt_grupo.value
        var mensagem = ''

        if (nomeLogin == nomeSalvo && senhaLogin == senhaSalvo && grupoLogin == grupoSalvo) {
            div_2.style.display = 'none';
            div_3.style.display = 'block';
        } else {
            mensagem += 'Login Inválido! Informações não correspondem.'
            div_mensagemLogin.innerHTML = mensagem
        }
    }

    function compra() {
        var numeroAleatorio = Math.random() * 9 + 1
        var numeroInteiroProduto = numeroAleatorio.toFixed(0)
        var precoMedioAleatorio = Math.random() * 99 + 1
        var precoMedioDecimal = precoMedioAleatorio.toFixed(2)
        var totalCompra = numeroInteiroProduto * precoMedioAleatorio
        var desconto = 0
        var valorDesconto = ''
        var mensagem = ''

        if (grupoSalvo == 1) {
            desconto = 20
            valorDesconto = totalCompra * 0.20;
        } else if (grupoSalvo == 2) {
            desconto = 15
            valorDesconto = totalCompra * 0.15
        } else if (grupoSalvo == 3) {
            desconto = 10
            valorDesconto = totalCompra * 0.10
        } else if (grupoSalvo == 4) {
            desconto = 5
            valorDesconto = totalCompra * 0.5
        }
        var valorFinal = totalCompra - valorDesconto;

        mensagem += `Extrato de Compra<br>
                        ------------------------<br>
                        Quantidade de produtos: ${numeroInteiroProduto}<br>
                        Preço médio por produto: R$${precoMedioDecimal}<br>
                        Valor original: R$${totalCompra.toFixed(2)}<br>
                        Desconto: ${desconto}% (-R$${valorDesconto.toFixed(2)})<br>
                        Valor final: R$${valorFinal.toFixed(2)}<br>`
        div_mensagemCompra.innerHTML = mensagem
    }
</script>